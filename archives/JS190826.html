<!-- build time:Tue Dec 24 2019 16:52:24 GMT+0800 (GMT+08:00) --><!DOCTYPE HTML><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta http-equiv="Cache-Control" content="no-siteapp"><meta http-equiv="Cache-Control" content="no-transform"><meta name="renderer" content="webkit|ie-comp|ie-stand"><meta name="apple-mobile-web-app-capable" content="Onions说前端 - 从未如此简单有趣"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="browsermode" content="application"><meta name="screen-orientation" content="portrait"><link rel="dns-prefetch" href="http://algate.github.io"><meta name="keywords" content="JavaScript,WebApi"><meta name="description" content="1.closest（元素向上查询）closest跟querySelector相反，该元素可以向上查询，也就是可以查询到父元素：document.querySelector(“li”).close..."><meta name="robots" content="all"><meta name="google" content="all"><meta name="googlebot" content="all"><meta name="verify" content="all"><title>JavaScript好用的Web-Api | Onions说前端 - 从未如此简单有趣</title><link rel="alternate" href="/atom.xml" title="Onions说前端 - 从未如此简单有趣" type="application/atom+xml"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7"><link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0"><link rel="stylesheet" href="/css/style.css?rev=@@hash"><div><script type="text/javascript">var cnzz_protocol="https:"==document.location.protocol?"https://":"http://";document.write(unescape("%3Cspan id='cnzz_stat_icon_1276282118'%3E%3C/span%3E%3Cscript src='"+cnzz_protocol+"s96.cnzz.com/z_stat.php%3Fid%3D1276282118%26online%3D1%26show%3Dline' type='text/javascript'%3E%3C/script%3E"))</script></div><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?617bf75bfd954382202927d87bf48f13";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></head></html><!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]--><!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]--><body><header class="main-header"><div class="main-header-box"><div class="canvas-box"><canvas id="canvas"></canvas></div><a class="header-avatar" href="/" title="onions"><img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block"></a><div class="branding"><h2>不要跟我谈理想，我的理想是不工作</h2></div></div></header><nav class="main-navigation"><div class="container"><div class="row"><div class="col-sm-12"><div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav"><span class="sr-only"></span> <i class="fa fa-bars"></i> </span><a class="navbar-brand" href="http://algate.github.io">Onions说前端 - 从未如此简单有趣</a></div><div class="collapse navbar-collapse" id="main-menu"><ul class="menu"><li role="presentation" class="text-center"><a href="/"><i class="fa fa-home"></i>首页</a></li><li role="presentation" class="text-center"><a href="/categories/前端/"><i class="fa fa-chrome"></i>前端</a></li><li role="presentation" class="text-center"><a href="/categories/工具/"><i class="fa fa-wrench"></i>工具</a></li><li role="presentation" class="text-center"><a href="/archives/"><i class="fa fa-clock-o"></i>时间轴</a></li><li role="presentation" class="text-center"><a href="/categories/要闻/"><i class="fa fa-google-wallet"></i>要闻</a></li><li role="presentation" class="text-center"><a href="/categories/日记/"><i class="fa fa-book"></i>日记</a></li><li role="presentation" class="text-center"><a href="/404.html"><i class="fa fa-bug"></i>404</a></li></ul></div></div></div></div></nav><section class="content-wrap"><div class="container"><div class="row"><main class="col-md-8 main-content m-post"><p id="process"></p><article class="post"><div class="post-head"><h1 id="JavaScript好用的Web-Api">JavaScript好用的Web-Api</h1><div class="post-meta"><span class="categories-meta fa-wrap"><i class="fa fa-folder-open-o"></i> <a class="category-link" href="/categories/前端/">前端</a> </span><span class="fa-wrap"><i class="fa fa-tags"></i> <span class="tags-meta"><a class="tag-link" href="/tags/JavaScript/">JavaScript</a> <a class="tag-link" href="/tags/WebApi/">WebApi</a> </span></span><span class="fa-wrap"><i class="fa fa-clock-o"></i> <span class="date-meta">2019/08/26</span></span></div></div><div class="post-body post-content"><h3 id="1-closest（元素向上查询）"><a href="#1-closest（元素向上查询）" class="headerlink" title="1.closest（元素向上查询）"></a>1.closest（元素向上查询）</h3><ul><li>closest<br>跟querySelector相反，该元素可以向上查询，也就是可以查询到父元素：<br>document.querySelector(“li”).closest(“#nav”);</li></ul><h3 id="2-dataset（获取元素以”data-“为前缀的属性集合）"><a href="#2-dataset（获取元素以”data-“为前缀的属性集合）" class="headerlink" title="2.dataset（获取元素以”data-“为前缀的属性集合）"></a>2.dataset（获取元素以”data-“为前缀的属性集合）</h3><ul><li>dataset<br>就跟原生微信小程序一样，能获取标签上以”data-“为前缀的属性集合：</li></ul><p></p><p data-name="蜘蛛侠" data-age="16"></p><br>document.querySelector(“p”).dataset; // {name: “蜘蛛侠”, age: “16”}<br>注意：虽然可以用getAttribute方法获取任何属性值，但是性质却不一样，这是开发规范问题，凡是自定义属性都要加上data-前缀哦<p></p><h3 id="3-URLSearchParams（查询参数）"><a href="#3-URLSearchParams（查询参数）" class="headerlink" title="3.URLSearchParams（查询参数）"></a>3.URLSearchParams（查询参数）</h3><ul><li>URLSearchParams<br>假设浏览器的url参数是 “?name=蜘蛛侠&amp;age=16”：</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> URLSearchParams(location.search).get(<span class="string">"name"</span>); <span class="comment">// 蜘蛛侠</span></span><br></pre></td></tr></table></figure><h3 id="4-hidden（隐藏元素）"><a href="#4-hidden（隐藏元素）" class="headerlink" title="4.hidden（隐藏元素）"></a>4.hidden（隐藏元素）</h3><p>这是一个html属性，规定元素是否隐藏，表现跟css的display: none一致：<br><code>&lt;div hidden&gt;我被隐藏了&lt;/div&gt;</code><br><code>document.querySelector(&quot;div&quot;).hidden = true / false;</code></p><h3 id="5-classList（类名控制器）"><a href="#5-classList（类名控制器）" class="headerlink" title="5.classList（类名控制器）"></a>5.classList（类名控制器）</h3><ul><li>classList<br>这是一个对象，该对象里封装了许多操作元素类名的方法：<br><code>&lt;p class=&quot;title&quot;&gt;&lt;/p&gt;</code><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> elem = <span class="built_in">document</span>.querySelector(<span class="string">"p"</span>);</span><br><span class="line"><span class="comment">// 增加类名</span></span><br><span class="line">elem.classList.add(<span class="string">"title-new"</span>); <span class="comment">// "title title-new"</span></span><br><span class="line"><span class="comment">// 删除类名</span></span><br><span class="line">elem.classList.remove(<span class="string">"title"</span>); <span class="comment">// "title-new"</span></span><br><span class="line"><span class="comment">// 切换类名（有则删、无则增，常用于一些切换操作，如显示/隐藏）</span></span><br><span class="line">elem.classList.toggle(<span class="string">"title"</span>); <span class="comment">// "title-new title"</span></span><br><span class="line"><span class="comment">// 替换类名</span></span><br><span class="line">elem.classList.replace(<span class="string">"title"</span>, <span class="string">"title-old"</span>); <span class="comment">// "title-new title-old"</span></span><br><span class="line"><span class="comment">// 是否包含指定类名</span></span><br><span class="line">elem.classList.contains(<span class="string">"title"</span>); <span class="comment">// false</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="6-contains（判断是否包含指定元素）"><a href="#6-contains（判断是否包含指定元素）" class="headerlink" title="6.contains（判断是否包含指定元素）"></a>6.contains（判断是否包含指定元素）</h3><ul><li>contains<br>可以判断指定元素是否包含了指定的子元素：<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">document.querySelector("div").contains(document.querySelector("p")); // true</span><br></pre></td></tr></table></figure></li></ul><h3 id="7-online-state（网络状态）"><a href="#7-online-state（网络状态）" class="headerlink" title="7.online state（网络状态）"></a>7.online state（网络状态）</h3><ul><li>online state<br>监听当前的网络状态变动，然后执行对应的方法：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">"online"</span>, xxx);</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">"offline"</span>, () =&gt; &#123;</span><br><span class="line">  alert(<span class="string">"你断网啦！"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li></ul><p>使用场景：提示用户已断网，直接一个弹框把用户吓懵</p><h3 id="8-battery-state（电池状态）"><a href="#8-battery-state（电池状态）" class="headerlink" title="8.battery state（电池状态）"></a>8.battery state（电池状态）</h3><ul><li>battery state<br>获取设备的电池状态：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">navigator.getBattery().then(<span class="function"><span class="params">battery</span> =&gt;</span> <span class="built_in">console</span>.log(battery));</span><br><span class="line"><span class="comment">// 返回</span></span><br><span class="line">&#123;</span><br><span class="line">  charging, <span class="comment">// 是否在充电</span></span><br><span class="line">  chargingTime, <span class="comment">// 充满电所需时间</span></span><br><span class="line">  dischargingTime, <span class="comment">// 当前电量可使用时间</span></span><br><span class="line">  level, 剩余电量</span><br><span class="line"></span><br><span class="line">  onchargingchange, <span class="comment">// 监听充电状态变化</span></span><br><span class="line">  onchargingtimechange, <span class="comment">// 监听充满电所需时间变化</span></span><br><span class="line">  ondischargingtimechange, <span class="comment">// 监听当前电量可使用时间变化</span></span><br><span class="line">  onlevelchange <span class="comment">// 监听电量变化</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>使用场景：提示用户电量已充满，或者为了让用户有安全感，电量低于99%的时候来个弹框提示”该充电啦”</p><h3 id="9-vibration（设备震动）"><a href="#9-vibration（设备震动）" class="headerlink" title="9.vibration（设备震动）"></a>9.vibration（设备震动）</h3><p>嘻嘻，使设备进行震动：<br>// 震动一次<br>navigator.vibrate(100);<br>// 连续震动，震动200ms、暂停100ms、震动300ms<br>navigator.vibrate([200, 100, 300]);<br>效果如下：不好意思你得用你自己的手握住手机才能感受得到;<br>使用场景：通过振动来提供感官反馈，比如太久没有触摸屏幕的时候连续震动提醒用户</p><h3 id="10-page-visibility（页面可见性）"><a href="#10-page-visibility（页面可见性）" class="headerlink" title="10.page visibility（页面可见性）"></a>10.page visibility（页面可见性）</h3><p>顾名思义，这个API是用来监听页面可见性变化的，在PC端标签栏切换、最小化会触发、在移动端程序切到后台会触发，简单说就是页面消失了🤦‍♂️<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.addEventListener(<span class="string">"visibilitychange"</span>, () =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`页面可见性：<span class="subst">$&#123;<span class="built_in">document</span>.visibilityState&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p></p><p>PC端效果如下：<br><img src="/images/js_webapi_visibility.gif" alt="image"><br>移动端效果如下：<br><img src="/images/js_webapi_visibility_app.gif" alt="image"><br>使用场景：当程序切到后台的时候，如果当前有视频播放或者一些动画执行，可以先暂停</p><h3 id="11-deviceOrientation（陀螺仪）"><a href="#11-deviceOrientation（陀螺仪）" class="headerlink" title="11.deviceOrientation（陀螺仪）"></a>11.deviceOrientation（陀螺仪）</h3><ul><li>deviceOrientation<br>陀螺仪，也就是设备的方向，又名重力感应，该API在IOS设备上失效的解决办法，将域名协议改成https；<br><img src="/images/js_webapi_deviceOrientation.jpg" alt="image"><br>从左到右分别为alpha、beta、gamma:<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">"deviceorientation"</span>, event =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> &#123;</span><br><span class="line">    alpha,</span><br><span class="line">    beta,</span><br><span class="line">    gamma</span><br><span class="line">  &#125; = event;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`alpha：<span class="subst">$&#123;alpha&#125;</span>`</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`beta：<span class="subst">$&#123;beta&#125;</span>`</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">`gamma：<span class="subst">$&#123;gamma&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li></ul><p>使用场景：页面上的某些元素需要根据手机摆动进行移动，达到视差的效果，比如王者荣耀进入游戏的那个界面，手机转动背景图会跟着动</p><h3 id="12-toDataUrl（画布内容转base64）"><a href="#12-toDataUrl（画布内容转base64）" class="headerlink" title="12.toDataUrl（画布内容转base64）"></a>12.toDataUrl（画布内容转base64）</h3><ul><li>toDataURL<br>这个canvas的API，作用是将画布的内容转换成一个base64的图片地址：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> canvas = <span class="built_in">document</span>.querySelector(<span class="string">"canvas"</span>);</span><br><span class="line"><span class="keyword">let</span> context = canvas.getContext(<span class="string">"2d"</span>);</span><br><span class="line"><span class="comment">//……</span></span><br><span class="line"><span class="keyword">let</span> url = canvas.toDataURL(<span class="string">"image/png"</span>); <span class="comment">// 将画布内容转换成base64地址</span></span><br></pre></td></tr></table></figure></li></ul><p>使用a标签进行图片下载时，图片链接跨域（图片是我的掘金头像），无法进行下载而是进行图片预览：<br></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"xxx"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"xxx"</span> <span class="attr">download</span>=<span class="string">"avatar"</span>&gt;</span>下载图片<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p><p>封装以下代码便可解决✅<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> downloadImage = <span class="function">(<span class="params">url, name</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 实例化画布</span></span><br><span class="line">  <span class="keyword">let</span> canvas = <span class="built_in">document</span>.createElement(<span class="string">"canvas"</span>);</span><br><span class="line">  <span class="keyword">let</span> context = canvas.getContext(<span class="string">"2d"</span>);</span><br><span class="line">  <span class="comment">// 实例化一个图片对象</span></span><br><span class="line">  <span class="keyword">let</span> image = <span class="keyword">new</span> Image();</span><br><span class="line">  image.crossOrigin = <span class="string">"Anonymous"</span>;</span><br><span class="line">  image.src = url;</span><br><span class="line">  <span class="comment">// 当图片加载完毕</span></span><br><span class="line">  image.onload = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 将图片画在画布上</span></span><br><span class="line">    canvas.height = image.height;</span><br><span class="line">    canvas.width = image.width;</span><br><span class="line">    context.drawImage(image, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="comment">// 将画布的内容转换成base64地址</span></span><br><span class="line">    <span class="keyword">let</span> dataURL = canvas.toDataURL(<span class="string">"image/png"</span>);</span><br><span class="line">    <span class="comment">// 创建a标签模拟点击进行下载</span></span><br><span class="line">    <span class="keyword">let</span> a = <span class="built_in">document</span>.createElement(<span class="string">"a"</span>);</span><br><span class="line">    a.hidden = <span class="literal">true</span>;</span><br><span class="line">    a.href = dataURL;</span><br><span class="line">    a.download = name;</span><br><span class="line">    <span class="built_in">document</span>.body.appendChild(a);</span><br><span class="line">    a.click();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>或者将当前的DOM转换成图片进行下载，常用于生成海报，推荐插件html2canvas，大家可以自己去搜;</p><h3 id="13-customEvent（自定义事件）"><a href="#13-customEvent（自定义事件）" class="headerlink" title="13.customEvent（自定义事件）"></a>13.customEvent（自定义事件）</h3><ul><li>customEvent<br>自定义事件，就跟vue里面的on跟emit一样；</li></ul><p>监听自定义事件：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">"follow"</span>, event =&gt; &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(event.detail); <span class="comment">// 输出 &#123;name: "前端宇宙情报局"&#125;</span></span><br><span class="line">&#125;);</span><br><span class="line">派发自定义事件：</span><br><span class="line"><span class="built_in">window</span>.dispatchEvent(<span class="keyword">new</span> CustomEvent(<span class="string">"follow"</span>, &#123;</span><br><span class="line">  detail: &#123;</span><br><span class="line">    name: <span class="string">"前端宇宙情报局"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure><p></p><h3 id="14-notification（桌面通知）"><a href="#14-notification（桌面通知）" class="headerlink" title="14.notification（桌面通知）"></a>14.notification（桌面通知）</h3><ul><li>notification<br>PC端的桌面通知，如网页端的微信，当收到消息时，右下角会出现一个通知（尽管你把浏览器最小化），因为这个通知时独立于浏览器的，是系统的一个原生控件：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> notice = <span class="keyword">new</span> Notification(<span class="string">"前端宇宙情报局"</span>, &#123;</span><br><span class="line">  body: <span class="string">"这20个不常用的Web API真的有用吗?，别问，问就是有用🈶"</span>,</span><br><span class="line">  icon: <span class="string">"我的掘金头像"</span>,</span><br><span class="line">  data: &#123;</span><br><span class="line">    url: <span class="string">"https://www.baidu.com"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 点击回调</span></span><br><span class="line">notice.onclick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">window</span>.open(notice.data.url); <span class="comment">// 当用户点击通知时，在浏览器打开百度网站</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>效果如下：<br><img src="/images/js_webapi_notification.gif" alt="image"></p><p>注意：想要成功的调起通知，首先要用户的授权✅</p><p>Notification.requestPermission(prem =&gt; {<br>prem == “granted” // 同意<br>prem == “denied” // 拒绝<br>})<br>所以，再调用之前先向用户发起请求：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> permission = Notification.permission;</span><br><span class="line"><span class="keyword">if</span> (permission == <span class="string">"granted"</span>) &#123;</span><br><span class="line">  <span class="comment">// 已同意，开始发送通知</span></span><br><span class="line">  ...</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (permission == <span class="string">"denied"</span>) &#123;</span><br><span class="line">  <span class="comment">// 不同意，发不了咯</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="comment">// 其他状态，可以重新发送授权提示</span></span><br><span class="line">  Notification.requestPermission();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="15-fullScreen（全屏）"><a href="#15-fullScreen（全屏）" class="headerlink" title="15.fullScreen（全屏）"></a>15.fullScreen（全屏）</h3><ul><li>fullScreen<br>全屏不咯? 之前的一个项目刚好用上，不仅仅可以作用在documentElement上，还可以作用在指定元素：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @method launchFullScreen 开启全屏</span></span><br><span class="line"><span class="comment"> * @param &#123;Object&#125; elem = document.documentElement 作用的元素</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> launchFullScreen = <span class="function">(<span class="params">elem = <span class="built_in">document</span>.documentElement</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span>(elem.requestFullScreen) &#123;</span><br><span class="line">    elem.requestFullScreen();</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(elem.mozRequestFullScreen) &#123;</span><br><span class="line">    elem.mozRequestFullScreen();</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(elem.webkitRequestFullScreen) &#123;</span><br><span class="line">    elem.webkitRequestFullScreen();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>作用在documentElement上没啥可以介绍的咯，就相当于F11开启全屏：<br>那么作用在指定元素会是什么效果呢?<br><img src="/images/js_webapi_fullScreen.gif" alt="image"><br>就像效果图一样，会直接开启全屏，并且只显示指定的元素，元素的宽高填充了整个屏幕✅<br>关闭全屏的时候需要注意的是，统一用document对象：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @method exitFullScreen 关闭全屏</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> exitFullScreen = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">document</span>.exitFullscreen) &#123;</span><br><span class="line">    <span class="built_in">document</span>.exitFullscreen();</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">document</span>.mozCancelFullScreen) &#123;</span><br><span class="line">    <span class="built_in">document</span>.mozCancelFullScreen();</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">document</span>.webkitCancelFullScreen) &#123;</span><br><span class="line">    <span class="built_in">document</span>.webkitCancelFullScreen();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>使用场景：需要让用户专注去做某件事，比如代码编辑区的全屏</p><h3 id="16-orientation（屏幕方向）"><a href="#16-orientation（屏幕方向）" class="headerlink" title="16.orientation（屏幕方向）"></a>16.orientation（屏幕方向）</h3><ul><li>orientation<br>可以监听用户手机设备的旋转方向变化：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">"orientationchange"</span>, () =&gt; &#123;</span><br><span class="line">  <span class="built_in">document</span>.body.innerHTML += <span class="string">`&lt;p&gt;屏幕旋转后的角度值：<span class="subst">$&#123;<span class="built_in">window</span>.orientation&#125;</span>&lt;/p&gt;`</span>;</span><br><span class="line">&#125;, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure></li></ul><p>效果如下：<br><img src="/images/js_webapi_orientation.gif" alt="image"><br>也可以使用css的媒体查询：<br></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 竖屏时样式 */</span></span><br><span class="line">@media all and (orientation: portrait) &#123;</span><br><span class="line">  body::after &#123;</span><br><span class="line">    content: <span class="string">"竖屏"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 横屏时样式 */</span></span><br><span class="line">@media all and (orientation: landscape) &#123;</span><br><span class="line">  body::after &#123;</span><br><span class="line">    content: <span class="string">"横屏"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>使用场景：页面需要用户开启横屏来获得更好的体验</p><h3 id="17-getBoundingClientRect（元素空间结构详细信息）"><a href="#17-getBoundingClientRect（元素空间结构详细信息）" class="headerlink" title="17.getBoundingClientRect（元素空间结构详细信息）"></a>17.getBoundingClientRect（元素空间结构详细信息）</h3><ul><li>getBoundingClientRect<br>可以获取指定元素在当前页面的空间信息：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">elem.getBoundingClientRect();</span><br><span class="line"><span class="comment">// 返回</span></span><br><span class="line">&#123;</span><br><span class="line">  x: <span class="number">604.875</span>,</span><br><span class="line">  y: <span class="number">1312</span>,</span><br><span class="line">  width: <span class="number">701.625</span>,</span><br><span class="line">  height: <span class="number">31</span>,</span><br><span class="line">  top: <span class="number">1312</span>,</span><br><span class="line">  right: <span class="number">1306.5</span>,</span><br><span class="line">  bottom: <span class="number">1343</span>,</span><br><span class="line">  left: <span class="number">604.875</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>注意：top是距离文档顶部的距离，y则是距离可视窗口（浏览器屏幕）的顶部距离，如果浏览器滚动，top值不变，y值会变</p><p>· MDN <a href="https://developer.mozilla.org/zh-CN/docs/Web/API" target="_blank" rel="noopener">Web API接口</a></p></div><div class="reward" ontouchstart><div class="reward-wrap">赏<div class="reward-box"><span class="reward-type"><img class="alipay" src="/img/alipayimg.png"><b>支付宝打赏</b> </span><span class="reward-type"><img class="wechat" src="/img/weipayimg.png"><b>微信打赏</b></span></div></div><p class="reward-tip">赞赏是不耍流氓的鼓励</p></div><div class="post-footer"><div>转载声明：商业转载请联系作者获得授权,非商业转载请注明出处 © <a href target="_blank">Onions</a></div><div></div></div></article><div class="article-nav prev-next-wrap clearfix"><a href="/archives/JS190829.html" class="pre-post btn btn-default" title="内网穿透工具"><i class="fa fa-angle-left fa-fw"></i><span class="hidden-lg">上一篇</span> <span class="hidden-xs">内网穿透工具</span> </a><a href="/archives/JS190426.html" class="next-post btn btn-default" title="JavaScript工具相关使用"><span class="hidden-lg">下一篇</span> <span class="hidden-xs">JavaScript工具相关使用</span><i class="fa fa-angle-right fa-fw"></i></a></div><div id="comments"><div id="vcomments" class="valine"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="/assets/valine.min.js"></script><script>new Valine({av:AV,el:"#vcomments",appId:"XCBkrMT2cT5gHnAV3uKwy2Eo-gzGzoHsz",appKey:"bX6iJOMctdSEGOXysJloaoGN",placeholder:"不要和我谈理想，我的理想是不上班！",notify:!1,verify:!1,avatar:"onions",meta:"nick,mail".split(","),pageSize:"10",path:window.location.pathname,lang:"zh-CN".toLowerCase()})</script></div></main><aside id="article-toc" role="navigation" class="col-md-4"><div class="widget"><h3 class="title">文章目录</h3><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-closest（元素向上查询）"><span class="toc-text">1.closest（元素向上查询）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-dataset（获取元素以”data-“为前缀的属性集合）"><span class="toc-text">2.dataset（获取元素以”data-“为前缀的属性集合）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-URLSearchParams（查询参数）"><span class="toc-text">3.URLSearchParams（查询参数）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-hidden（隐藏元素）"><span class="toc-text">4.hidden（隐藏元素）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-classList（类名控制器）"><span class="toc-text">5.classList（类名控制器）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-contains（判断是否包含指定元素）"><span class="toc-text">6.contains（判断是否包含指定元素）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-online-state（网络状态）"><span class="toc-text">7.online state（网络状态）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-battery-state（电池状态）"><span class="toc-text">8.battery state（电池状态）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-vibration（设备震动）"><span class="toc-text">9.vibration（设备震动）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-page-visibility（页面可见性）"><span class="toc-text">10.page visibility（页面可见性）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-deviceOrientation（陀螺仪）"><span class="toc-text">11.deviceOrientation（陀螺仪）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-toDataUrl（画布内容转base64）"><span class="toc-text">12.toDataUrl（画布内容转base64）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-customEvent（自定义事件）"><span class="toc-text">13.customEvent（自定义事件）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-notification（桌面通知）"><span class="toc-text">14.notification（桌面通知）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-fullScreen（全屏）"><span class="toc-text">15.fullScreen（全屏）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-orientation（屏幕方向）"><span class="toc-text">16.orientation（屏幕方向）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-getBoundingClientRect（元素空间结构详细信息）"><span class="toc-text">17.getBoundingClientRect（元素空间结构详细信息）</span></a></li></ol></div></aside></div></div></section><footer class="main-footer"><div class="container"><div class="row"></div></div></footer><a id="back-to-top" class="icon-btn hide"><i class="fa fa-chevron-up"></i></a><div class="copyright"><div class="container"><div class="row"><div class="col-sm-12"><div class="busuanzi">访问量: <strong id="busuanzi_value_site_pv"><i class="fa fa-spinner fa-spin"></i> </strong>&nbsp; | &nbsp; 访客数: <strong id="busuanzi_value_site_uv"><i class="fa fa-spinner fa-spin"></i></strong></div></div><div class="col-sm-12"><span>版权所有 onions洋葱信息技术Copyright &copy; 2016-2019 </span>| <span>Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Hexo</a> </span>| <span>Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a></span></div></div></div></div><script src="/assets/tagcanvas.min.js?rev=2.9"></script><script>var tagOption={textColour:"#444",outlineMethod:"block",outlineColour:"#FFDAB9",interval:30,textHeight:13,outlineRadius:3,freezeActive:!0,frontSelect:!0,initial:[.1,-.1],depth:.5,decel:.95,maxSpeed:.03,reverse:!0,fadeIn:500,wheelZoom:!0};TagCanvas.Start("tag-cloud-3d","",tagOption)</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/assets/vector.js?rev=@@hash"></script><script src="/assets/reject.js?rev=@@hash"></script><script src="/js/app.js?rev=@@hash"></script></body><!-- rebuild by neat -->